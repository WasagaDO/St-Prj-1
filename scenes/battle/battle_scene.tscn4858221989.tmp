[gd_scene load_steps=96 format=3 uid="uid://cvp83fjtisnpi"]

[ext_resource type="Texture2D" uid="uid://l2d7txja67h7" path="res://assets/misc/Old Mill Final.png" id="1_0hcyc"]
[ext_resource type="PackedScene" uid="uid://dlgug5h82pnj5" path="res://scenes/battle/ui/bars/bars.tscn" id="4_6f28h"]
[ext_resource type="PackedScene" uid="uid://cixqxm0jpmef5" path="res://scenes/battle/cards/deck.tscn" id="7_i6lf0"]
[ext_resource type="Resource" uid="uid://mlcyxfv2ivp0" path="res://data/cards/active_defense.tres" id="8_ff4qw"]
[ext_resource type="Script" uid="uid://rh6rqvxn3rx0" path="res://data/scripts/card_slot.gd" id="9_dn6dx"]
[ext_resource type="PackedScene" uid="uid://brc8fwhvn5s1l" path="res://scenes/battle/cards/card.tscn" id="10_cji3i"]
[ext_resource type="Resource" uid="uid://bg60n250ekmi6" path="res://data/cards/deceptive_strike.tres" id="10_hr0ue"]
[ext_resource type="Script" uid="uid://dpn2blk45hmrd" path="res://scenes/battle/cards/hand.gd" id="11_pluhi"]
[ext_resource type="Resource" uid="uid://cxhlhjaxt1da" path="res://data/cards/dodge.tres" id="11_van6b"]
[ext_resource type="Resource" uid="uid://0c2r737s4881" path="res://data/cards/horizontal_cut.tres" id="12_hfool"]
[ext_resource type="Script" uid="uid://bvgdp22r7k7x7" path="res://scenes/battle/cards/card_manager.gd" id="12_o3gil"]
[ext_resource type="Resource" uid="uid://m2e55tpcd322" path="res://data/cards/gliding_strike.tres" id="13_kbog3"]
[ext_resource type="Script" uid="uid://b44yrs38c0yeg" path="res://scenes/battle/battle_manager.gd" id="13_m5uja"]
[ext_resource type="Resource" uid="uid://b3gpl0mt77wja" path="res://data/cards/jab.tres" id="13_rr1by"]
[ext_resource type="Resource" uid="uid://bqp6hqt8l66ky" path="res://data/cards/double_strike.tres" id="14_bewwa"]
[ext_resource type="PackedScene" uid="uid://7b2xta84ie5h" path="res://scenes/battle/ui/target_selection/target_selector.tscn" id="14_ovprx"]
[ext_resource type="Resource" uid="uid://dkttfuu7htvyw" path="res://data/cards/lunge.tres" id="14_q7opk"]
[ext_resource type="Resource" uid="uid://bsvmal5boc56b" path="res://data/cards/kick.tres" id="15_b6rjj"]
[ext_resource type="Resource" uid="uid://cd0ke7keiwnu5" path="res://data/cards/noggin_kick.tres" id="15_jodq2"]
[ext_resource type="PackedScene" uid="uid://bihp7rr2uqxld" path="res://scenes/player/player.tscn" id="16_8f82i"]
[ext_resource type="Script" uid="uid://cutn2lfqgnt71" path="res://scenes/battle/cards/dealer.gd" id="16_jltus"]
[ext_resource type="Resource" uid="uid://by5jslim0rd0f" path="res://data/cards/parry.tres" id="16_r0588"]
[ext_resource type="Resource" uid="uid://dpgb3yd0f5q31" path="res://data/cards/sprawling_punch.tres" id="17_0jlqh"]
[ext_resource type="Resource" uid="uid://c5w4nklj85i0j" path="res://data/cards/shield_bash.tres" id="17_0so8e"]
[ext_resource type="PackedScene" uid="uid://c6eh6dyhgsgg0" path="res://scenes/enemy/enemy.tscn" id="18_nndee"]
[ext_resource type="Resource" uid="uid://bce3c3hqkmne2" path="res://data/cards/weapon_grab.tres" id="18_s0olx"]
[ext_resource type="Resource" uid="uid://bskj3wiyc6sdt" path="res://data/cards/feint.tres" id="19_301yo"]
[ext_resource type="Resource" uid="uid://3mae7wxyuadm" path="res://data/cards/wide_swing.tres" id="19_e5nfj"]
[ext_resource type="Resource" uid="uid://dpl1x64oa5efg" path="res://data/cards/ramming_strike.tres" id="20_2n5on"]
[ext_resource type="Resource" uid="uid://c2fhjcy37ys7r" path="res://data/cards/agile_maneuver.tres" id="21_m0fgd"]
[ext_resource type="Resource" uid="uid://ct40w0eufijbo" path="res://data/cards/powerful_thrust.tres" id="22_ac7wl"]
[ext_resource type="Resource" uid="uid://7cy4bdn1ctqi" path="res://data/cards/circular_strike.tres" id="23_ytjid"]
[ext_resource type="Resource" uid="uid://d24cil55sy0hy" path="res://data/cards/distance_control.tres" id="24_03fk3"]
[ext_resource type="Resource" uid="uid://ophu6ua3hsf0" path="res://data/cards/quick_counterattack.tres" id="25_au34j"]
[ext_resource type="FontFile" uid="uid://krn0i701mii6" path="res://assets/fonts/MAYFLOWERANTIQUE (1)(1)(2).TTF" id="26_drgew"]
[ext_resource type="Resource" uid="uid://cxyoa1xb7n354" path="res://data/cards/crushing_blow.tres" id="26_fdqrj"]
[ext_resource type="Texture2D" uid="uid://d0opntfigbwrf" path="res://assets/ui/backpack closed.png" id="26_si0dq"]
[ext_resource type="Resource" uid="uid://kffdlj5dqjq3" path="res://data/enemies/goatman/goatman.tres" id="26_vwuyc"]
[ext_resource type="Resource" uid="uid://cooinsn46rxg7" path="res://data/cards/leg_strike.tres" id="27_becrk"]
[ext_resource type="Script" uid="uid://cupg58xub85an" path="res://scenes/battle/status_popup_manager.gd" id="27_mfn67"]
[ext_resource type="PackedScene" uid="uid://vs4mnjf7dn4a" path="res://scenes/battle/ui/status_popup.tscn" id="28_evgrh"]
[ext_resource type="Resource" uid="uid://ev13s10ogqxi" path="res://data/cards/precise_strike.tres" id="28_x3gp7"]
[ext_resource type="Script" uid="uid://cjhgdj2g4qopw" path="res://scenes/battle/ui/battle_alert.gd" id="28_xevio"]
[ext_resource type="Resource" uid="uid://dpblkqhytlh0a" path="res://data/cards/sudden_throw.tres" id="29_bvq7d"]
[ext_resource type="Script" uid="uid://cyuo7tkv0rbis" path="res://scenes/battle/ui/logs/logs.gd" id="29_mj1lp"]
[ext_resource type="PackedScene" uid="uid://jquvrnm2nybh" path="res://scenes/battle/ui/logs/log_message.tscn" id="29_wskmf"]
[ext_resource type="Resource" uid="uid://k65wkgf3houj" path="res://data/cards/power_block.tres" id="30_kaah5"]
[ext_resource type="Resource" uid="uid://b2gmia7x36kvp" path="res://data/cards/elbow_strike.tres" id="31_dmmaj"]
[ext_resource type="Script" uid="uid://bd6kq1gnvohy0" path="res://scenes/battle/events/events.gd" id="31_go2ce"]
[ext_resource type="PackedScene" uid="uid://deqgifofr0xk2" path="res://scenes/battle/events/battle_events/damage_event.tscn" id="33_1yotk"]
[ext_resource type="PackedScene" uid="uid://fdpp3thjfhyx" path="res://scenes/battle/events/battle_events/armor_damage_event.tscn" id="34_a8wsi"]
[ext_resource type="PackedScene" uid="uid://vuj1phmqegpr" path="res://scenes/battle/events/battle_events/heal_event.tscn" id="35_8dhsw"]
[ext_resource type="PackedScene" uid="uid://daffehj1kva0w" path="res://scenes/battle/events/battle_events/armor_heal_event.tscn" id="36_s0fps"]
[ext_resource type="PackedScene" uid="uid://b6l1ys4rqnc57" path="res://scenes/battle/events/state_events/enemy_move_played_event.tscn" id="37_mpgih"]
[ext_resource type="PackedScene" uid="uid://dakjnfsa0jk6u" path="res://scenes/battle/events/state_events/card_played_event.tscn" id="39_gh2so"]
[ext_resource type="PackedScene" uid="uid://e3juvlur7cd7" path="res://scenes/battle/events/state_events/new_turn_event.tscn" id="40_18j3u"]
[ext_resource type="PackedScene" uid="uid://cubgdjkworik0" path="res://scenes/battle/events/state_events/end_of_game_event.tscn" id="40_t6ak5"]
[ext_resource type="Texture2D" uid="uid://bv5iyg1mcyuk4" path="res://assets/ui/circle_button.png" id="40_u24ob"]
[ext_resource type="PackedScene" uid="uid://lmttoefckcl2" path="res://scenes/battle/events/state_events/player_can_react_event.tscn" id="41_ho70s"]
[ext_resource type="PackedScene" uid="uid://ddevk2tyrxskr" path="res://scenes/battle/events/state_events/start_of_game_event.tscn" id="41_jpniv"]
[ext_resource type="PackedScene" uid="uid://b7jk4c6e3tluy" path="res://scenes/battle/events/react_events/attack_dodged_event.tscn" id="42_i3ye5"]
[ext_resource type="PackedScene" uid="uid://cbinw3r6wni0k" path="res://scenes/battle/events/battle_events/card_resolved_event.tscn" id="44_gpbrr"]
[ext_resource type="PackedScene" uid="uid://qjn0sxvwnccc" path="res://scenes/battle/events/battle_events/end_turn_event.tscn" id="44_i32r0"]
[ext_resource type="PackedScene" uid="uid://c60ncshk4otu6" path="res://scenes/battle/events/battle_events/status_applied.tscn" id="45_40ag2"]
[ext_resource type="PackedScene" uid="uid://ij7gsovl7fxo" path="res://scenes/battle/events/battle_events/status_wore_off.tscn" id="46_7a5bm"]

[sub_resource type="Resource" id="Resource_yqjmm"]
script = ExtResource("9_dn6dx")
card = ExtResource("12_hfool")
copies = 3

[sub_resource type="Resource" id="Resource_ocq4n"]
script = ExtResource("9_dn6dx")
card = ExtResource("13_rr1by")
copies = 3

[sub_resource type="Resource" id="Resource_mqs75"]
script = ExtResource("9_dn6dx")
card = ExtResource("15_jodq2")
copies = 3

[sub_resource type="Resource" id="Resource_otbtb"]
script = ExtResource("9_dn6dx")
card = ExtResource("17_0jlqh")
copies = 1

[sub_resource type="Resource" id="Resource_ugkr7"]
script = ExtResource("9_dn6dx")
card = ExtResource("19_e5nfj")
copies = 1

[sub_resource type="Resource" id="Resource_ptoyu"]
script = ExtResource("9_dn6dx")
card = ExtResource("14_q7opk")
copies = 1

[sub_resource type="Resource" id="Resource_v3khq"]
script = ExtResource("9_dn6dx")
card = ExtResource("11_van6b")
copies = 2

[sub_resource type="Resource" id="Resource_6gbfq"]
script = ExtResource("9_dn6dx")
card = ExtResource("10_hr0ue")
copies = 1

[sub_resource type="Resource" id="Resource_7ndk8"]
script = ExtResource("9_dn6dx")
card = ExtResource("8_ff4qw")
copies = 3

[sub_resource type="Resource" id="Resource_bewwa"]
script = ExtResource("9_dn6dx")
card = ExtResource("13_kbog3")
copies = 2
metadata/_custom_type_script = "uid://rh6rqvxn3rx0"

[sub_resource type="Resource" id="Resource_kbog3"]
script = ExtResource("9_dn6dx")
card = ExtResource("14_bewwa")
copies = 2
metadata/_custom_type_script = "uid://rh6rqvxn3rx0"

[sub_resource type="Resource" id="Resource_folwx"]
script = ExtResource("9_dn6dx")
card = ExtResource("15_b6rjj")
copies = 2
metadata/_custom_type_script = "uid://rh6rqvxn3rx0"

[sub_resource type="Resource" id="Resource_rkb8f"]
script = ExtResource("9_dn6dx")
card = ExtResource("16_r0588")
copies = 2
metadata/_custom_type_script = "uid://rh6rqvxn3rx0"

[sub_resource type="Resource" id="Resource_ajuk0"]
script = ExtResource("9_dn6dx")
card = ExtResource("17_0so8e")
copies = 2
metadata/_custom_type_script = "uid://rh6rqvxn3rx0"

[sub_resource type="Resource" id="Resource_6v43u"]
script = ExtResource("9_dn6dx")
card = ExtResource("18_s0olx")
copies = 2
metadata/_custom_type_script = "uid://rh6rqvxn3rx0"

[sub_resource type="Resource" id="Resource_u3ojb"]
script = ExtResource("9_dn6dx")
card = ExtResource("19_301yo")
copies = 2
metadata/_custom_type_script = "uid://rh6rqvxn3rx0"

[sub_resource type="Resource" id="Resource_lqsp4"]
script = ExtResource("9_dn6dx")
card = ExtResource("20_2n5on")
copies = 2
metadata/_custom_type_script = "uid://rh6rqvxn3rx0"

[sub_resource type="Resource" id="Resource_ema6m"]
script = ExtResource("9_dn6dx")
card = ExtResource("21_m0fgd")
copies = 20
metadata/_custom_type_script = "uid://rh6rqvxn3rx0"

[sub_resource type="Resource" id="Resource_e6ws5"]
script = ExtResource("9_dn6dx")
card = ExtResource("22_ac7wl")
copies = 2
metadata/_custom_type_script = "uid://rh6rqvxn3rx0"

[sub_resource type="Resource" id="Resource_til0e"]
script = ExtResource("9_dn6dx")
card = ExtResource("23_ytjid")
copies = 2
metadata/_custom_type_script = "uid://rh6rqvxn3rx0"

[sub_resource type="Resource" id="Resource_ps7l8"]
script = ExtResource("9_dn6dx")
card = ExtResource("24_03fk3")
copies = 2
metadata/_custom_type_script = "uid://rh6rqvxn3rx0"

[sub_resource type="Resource" id="Resource_cs065"]
script = ExtResource("9_dn6dx")
card = ExtResource("25_au34j")
copies = 2
metadata/_custom_type_script = "uid://rh6rqvxn3rx0"

[sub_resource type="Resource" id="Resource_c7h7c"]
script = ExtResource("9_dn6dx")
card = ExtResource("26_fdqrj")
copies = 2
metadata/_custom_type_script = "uid://rh6rqvxn3rx0"

[sub_resource type="Resource" id="Resource_ascb6"]
script = ExtResource("9_dn6dx")
card = ExtResource("27_becrk")
copies = 2
metadata/_custom_type_script = "uid://rh6rqvxn3rx0"

[sub_resource type="Resource" id="Resource_c5cw1"]
script = ExtResource("9_dn6dx")
card = ExtResource("28_x3gp7")
copies = 2
metadata/_custom_type_script = "uid://rh6rqvxn3rx0"

[sub_resource type="Resource" id="Resource_wfi3p"]
script = ExtResource("9_dn6dx")
card = ExtResource("29_bvq7d")
copies = 2
metadata/_custom_type_script = "uid://rh6rqvxn3rx0"

[sub_resource type="Resource" id="Resource_arddj"]
script = ExtResource("9_dn6dx")
card = ExtResource("30_kaah5")
copies = 2
metadata/_custom_type_script = "uid://rh6rqvxn3rx0"

[sub_resource type="Resource" id="Resource_xw5x7"]
script = ExtResource("9_dn6dx")
card = ExtResource("31_dmmaj")
copies = 2
metadata/_custom_type_script = "uid://rh6rqvxn3rx0"

[sub_resource type="LabelSettings" id="LabelSettings_vv33i"]
font_size = 64

[sub_resource type="LabelSettings" id="LabelSettings_qtnqa"]
font = ExtResource("26_drgew")
font_size = 100

[node name="BattleScene" type="Node2D"]

[node name="Background" type="Sprite2D" parent="."]
position = Vector2(960, 540)
scale = Vector2(0.5, 0.5)
texture = ExtResource("1_0hcyc")
metadata/_edit_lock_ = true

[node name="ColorRect" type="ColorRect" parent="."]
modulate = Color(1, 1, 1, 0)
offset_right = 2033.0
offset_bottom = 1141.0
mouse_filter = 2
color = Color(0, 0, 0, 1)

[node name="Cards" type="Node2D" parent="."]
z_index = 100

[node name="Deck" parent="Cards" node_paths=PackedStringArray("card_manager", "refill_deck") instance=ExtResource("7_i6lf0")]
position = Vector2(198, 921)
scale = Vector2(0.5, 0.5)
card_manager = NodePath("../CardManager")
face_down = true
starting_cards = Array[ExtResource("9_dn6dx")]([SubResource("Resource_yqjmm"), SubResource("Resource_ocq4n"), SubResource("Resource_mqs75"), SubResource("Resource_otbtb"), SubResource("Resource_ugkr7"), SubResource("Resource_ptoyu"), SubResource("Resource_v3khq"), SubResource("Resource_6gbfq"), SubResource("Resource_7ndk8"), SubResource("Resource_bewwa"), SubResource("Resource_kbog3"), SubResource("Resource_folwx"), SubResource("Resource_rkb8f"), SubResource("Resource_ajuk0"), SubResource("Resource_6v43u"), SubResource("Resource_u3ojb"), SubResource("Resource_lqsp4"), SubResource("Resource_ema6m"), SubResource("Resource_e6ws5"), SubResource("Resource_til0e"), SubResource("Resource_ps7l8"), SubResource("Resource_cs065"), SubResource("Resource_c7h7c"), SubResource("Resource_ascb6"), SubResource("Resource_c5cw1"), SubResource("Resource_wfi3p"), SubResource("Resource_arddj"), SubResource("Resource_xw5x7")])
card_scene = ExtResource("10_cji3i")
refill_deck = NodePath("../DiscardPile")
snap_cards_in_place = true
hide_cards = true

[node name="DiscardPile" parent="Cards" node_paths=PackedStringArray("card_manager") instance=ExtResource("7_i6lf0")]
position = Vector2(1837, 730)
scale = Vector2(0.5, 0.5)
card_manager = NodePath("../CardManager")
face_down = true
card_scene = ExtResource("10_cji3i")
is_pile = true
messy_rotation_offset = 10

[node name="Hand" type="Node2D" parent="Cards" node_paths=PackedStringArray("card_manager", "target_selector")]
position = Vector2(715, 938)
script = ExtResource("11_pluhi")
card_manager = NodePath("../CardManager")
card_separation = 150.0
target_selector = NodePath("../../UI/TargetSelector")
card_y_max = 150.0
card_hovered_y_offset = -80.0
enabled = false

[node name="CardManager" type="Node2D" parent="Cards"]
script = ExtResource("12_o3gil")

[node name="Dealer" type="Node2D" parent="Cards" node_paths=PackedStringArray("hand", "deck")]
script = ExtResource("16_jltus")
hand = NodePath("../Hand")
deck = NodePath("../Deck")

[node name="Protagonist" parent="." node_paths=PackedStringArray("hand") instance=ExtResource("16_8f82i")]
position = Vector2(536, 553)
scale = Vector2(0.2, 0.2)
hand = NodePath("../Cards/Hand")
max_stamina = 30
log_name = "Player"

[node name="Bars" parent="Protagonist" instance=ExtResource("4_6f28h")]
position = Vector2(-300, -1690)
scale = Vector2(1.255, 1.31111)

[node name="Enemy" parent="." instance=ExtResource("18_nndee")]
position = Vector2(1328, 511)
scale = Vector2(0.18, 0.18)
enemy_data = ExtResource("26_vwuyc")
max_stamina = 30
log_name = "Goat Man"

[node name="Bars" parent="Enemy" instance=ExtResource("4_6f28h")]
position = Vector2(500, -1666.67)
scale = Vector2(1.27222, 1.37778)

[node name="UI" type="Node2D" parent="."]

[node name="TargetSelector" parent="UI" instance=ExtResource("14_ovprx")]
z_index = 99

[node name="EndTurnButton" type="Button" parent="UI"]
offset_left = 1630.0
offset_top = 829.0
offset_right = 1896.0
offset_bottom = 944.0
theme_override_font_sizes/font_size = 32
text = "End Turn"

[node name="Alert" type="Label" parent="UI"]
visible = false
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -2.0
offset_top = 414.0
offset_right = 1915.0
offset_bottom = 502.0
grow_horizontal = 2
grow_vertical = 2
text = "Out of stamina!"
label_settings = SubResource("LabelSettings_vv33i")
horizontal_alignment = 1
vertical_alignment = 1
script = ExtResource("28_xevio")

[node name="Debug Infos" type="Control" parent="UI"]
layout_mode = 3
anchors_preset = 0
offset_left = 71.0
offset_top = 31.0
offset_right = 1889.0
offset_bottom = 143.0

[node name="Player Debug Infos" type="RichTextLabel" parent="UI/Debug Infos"]
layout_mode = 0
offset_right = 662.0
offset_bottom = 115.0

[node name="Enemy Debug Infos" type="RichTextLabel" parent="UI/Debug Infos"]
layout_mode = 0
offset_left = 1106.0
offset_top = -2.0
offset_right = 1768.0
offset_bottom = 113.0

[node name="Log" type="Control" parent="UI" node_paths=PackedStringArray("message_parent")]
clip_contents = true
layout_mode = 3
anchors_preset = 0
offset_left = 1646.0
offset_top = 253.0
offset_right = 1904.0
offset_bottom = 634.0
mouse_filter = 2
script = ExtResource("29_mj1lp")
max_logs = 20
message_parent = NodePath("ScrollContainer/MarginContainer/VBoxContainer")
message_scene = ExtResource("29_wskmf")

[node name="ColorRect" type="ColorRect" parent="UI/Log"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
color = Color(0, 0, 0, 0.568627)

[node name="ScrollContainer" type="ScrollContainer" parent="UI/Log"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
horizontal_scroll_mode = 0
vertical_scroll_mode = 2

[node name="MarginContainer" type="MarginContainer" parent="UI/Log/ScrollContainer"]
layout_mode = 2
size_flags_horizontal = 3
size_flags_vertical = 3
theme_override_constants/margin_left = 7
theme_override_constants/margin_top = 7
theme_override_constants/margin_right = 7
theme_override_constants/margin_bottom = 7

[node name="VBoxContainer" type="VBoxContainer" parent="UI/Log/ScrollContainer/MarginContainer"]
layout_mode = 2
size_flags_vertical = 8
alignment = 2

[node name="CanvasLayer" type="CanvasLayer" parent="UI"]

[node name="StateOverlay" type="ColorRect" parent="UI/CanvasLayer"]
visible = false
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
color = Color(0.145098, 0.145098, 0.145098, 0.6)

[node name="Label" type="Label" parent="UI/CanvasLayer/StateOverlay"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
text = "Game over!"
label_settings = SubResource("LabelSettings_qtnqa")
horizontal_alignment = 1
vertical_alignment = 1

[node name="CircleButton" type="Sprite2D" parent="UI"]
position = Vector2(198, 918)
scale = Vector2(0.1, 0.1)
texture = ExtResource("40_u24ob")

[node name="BackpackClosed" type="Sprite2D" parent="UI/CircleButton"]
position = Vector2(-10, 40)
scale = Vector2(0.532, 0.532)
texture = ExtResource("26_si0dq")

[node name="StatusPopups_Player" type="Control" parent="UI"]
layout_mode = 3
anchors_preset = 0
offset_left = 420.0
offset_top = 524.0
offset_right = 420.0
offset_bottom = 524.0
script = ExtResource("27_mfn67")
stat_popup_scene = ExtResource("28_evgrh")

[node name="StatusPopups_Enemy" type="Control" parent="UI"]
layout_mode = 3
anchors_preset = 0
offset_left = 1445.0
offset_top = 478.0
offset_right = 1445.0
offset_bottom = 478.0
script = ExtResource("27_mfn67")
stat_popup_scene = ExtResource("28_evgrh")

[node name="BattleManager" type="Node2D" parent="." node_paths=PackedStringArray("player", "deck", "hand", "discard_pile", "enemies")]
script = ExtResource("13_m5uja")
player = NodePath("../Protagonist")
deck = NodePath("../Cards/Deck")
hand = NodePath("../Cards/Hand")
discard_pile = NodePath("../Cards/DiscardPile")
enemies = [NodePath("../Enemy")]

[node name="Events" type="Node" parent="." node_paths=PackedStringArray("hand", "deck", "dealer", "discard_pile", "state_overlay", "end_turn_button", "darken_overlay", "stat_popups_player", "stat_popups_enemy")]
script = ExtResource("31_go2ce")
hand = NodePath("../Cards/Hand")
deck = NodePath("../Cards/Deck")
dealer = NodePath("../Cards/Dealer")
discard_pile = NodePath("../Cards/DiscardPile")
state_overlay = NodePath("../UI/CanvasLayer/StateOverlay")
event_handlers = Array[PackedScene]([ExtResource("34_a8wsi"), ExtResource("36_s0fps"), ExtResource("33_1yotk"), ExtResource("35_8dhsw"), ExtResource("42_i3ye5"), ExtResource("39_gh2so"), ExtResource("37_mpgih"), ExtResource("40_18j3u"), ExtResource("41_ho70s"), ExtResource("40_t6ak5"), ExtResource("41_jpniv"), ExtResource("44_gpbrr"), ExtResource("44_i32r0"), ExtResource("45_40ag2"), ExtResource("46_7a5bm")])
end_turn_button = NodePath("../UI/EndTurnButton")
darken_overlay = NodePath("../ColorRect")
stat_popups_player = NodePath("../UI/StatusPopups_Player")
stat_popups_enemy = NodePath("../UI/StatusPopups_Enemy")
end_scene_path = "res://scenes/session_settings/session_settings.tscn"

[connection signal="card_played" from="Cards/Hand" to="BattleManager" method="_on_hand_card_played"]
[connection signal="not_enough_stamina" from="Protagonist" to="UI/Alert" method="_on_protagonist_not_enough_stamina"]
[connection signal="move_made" from="Enemy" to="BattleManager" method="_on_enemy_move_made"]
[connection signal="cancelled" from="UI/TargetSelector" to="Cards/Hand" method="_on_target_selector_cancelled"]
[connection signal="target_selected" from="UI/TargetSelector" to="Cards/Hand" method="_on_target_selector_target_selected"]
[connection signal="pressed" from="UI/EndTurnButton" to="BattleManager" method="_on_end_turn_button_pressed"]
[connection signal="queue_empty" from="Events" to="BattleManager" method="_on_events_queue_empty"]
